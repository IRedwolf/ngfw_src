Ext.define("Ung.config.network.Network",{extend:"Ext.tab.Panel",xtype:"ung.config.network",requires:["Ung.config.network.NetworkController","Ung.config.network.NetworkModel","Ung.view.grid.Grid","Ung.store.RuleConditions","Ung.store.Rule","Ung.model.Rule","Ung.cmp.Rules"],controller:"config.network",viewModel:{type:"config.network"},dockedItems:[{xtype:"toolbar",weight:-10,border:!1,items:[{text:"Back",iconCls:"fa fa-arrow-circle-left fa-lg",hrefTarget:"_self",href:"#config"},"-",{xtype:"component",html:"Network"}]},{xtype:"toolbar",dock:"bottom",border:!1,items:["->",{text:"Apply Changes".t(),iconCls:"fa fa-floppy-o fa-lg",handler:"saveSettings"}]}],items:[{xtype:"config.network.interfaces"},{xtype:"config.network.hostname"},{xtype:"config.network.services"},{xtype:"config.network.portforwardrules"},{xtype:"config.network.natrules"},{xtype:"config.network.bypassrules"},{xtype:"config.network.routes"},{xtype:"config.network.dnsserver"},{xtype:"config.network.dhcpserver"},{xtype:"config.network.advanced"},{xtype:"config.network.troubleshooting"}]}),Ext.define("Ung.config.network.NetworkController",{extend:"Ext.app.ViewController",alias:"controller.config.network",control:{"#":{beforerender:"loadSettings"},"#interfaces":{beforeactivate:"onInterfaces"},"#interfacesGrid":{},"#interfaceStatus":{beforeedit:function(){return!1}},"#interfaceArp":{},networktest:{afterrender:"networkTestRender"}},saveSettings:function(){var e=this.getView(),t=this.getViewModel();e.setLoading("Saving ..."),Ext.ComponentQuery.query("rules").forEach(function(e){var i=e.getStore();i.getModifiedRecords().length>0&&(i.each(function(e,t){e.get("markedForDelete")&&e.drop()}),t.set(e.listProperty,Ext.Array.pluck(i.getRange(),"data")),i.commitChanges())}),rpc.networkManager.setNetworkSettings(function(t,i){return e.setLoading(!1),i?void console.log(i):void console.log(t)},t.get("settings"))},loadSettings:function(){var e=this;rpc.networkManager.getNetworkSettings(function(t,i){e.getViewModel().set("settings",t),e.loadInterfaceStatusAndDevices(),console.log(t)})},loadInterfaceStatusAndDevices:function(){var e,t,i,n,a=this.getViewModel(),r=a.get("settings.interfaces.list");rpc.networkManager.getInterfaceStatus(function(n,d){for(e=0;e<r.length;e+=1)for(Ext.apply(r[e],{v4Address:null,v4Netmask:null,v4Gateway:null,v4Dns1:null,v4Dns2:null,v4PrefixLength:null,v6Address:null,v6Gateway:null,v6PrefixLength:null}),t=0;t<n.list.length;t+=1)i=n.list[t],i.interfaceId===a.get("settings.interfaces.list")[e].interfaceId&&Ext.apply(r[e],{v4Address:i.v4Address,v4Netmask:i.v4Netmask,v4Gateway:i.v4Gateway,v4Dns1:i.v4Dns1,v4Dns2:i.v4Dns2,v4PrefixLength:i.v4PrefixLength,v6Address:i.v6Address,v6Gateway:i.v6Gateway,v6PrefixLength:i.v6PrefixLength});a.getStore("interfaces").reload()}),rpc.networkManager.getDeviceStatus(function(i,d){for(e=0;e<r.length;e+=1)for(Ext.apply(r[e],{deviceName:null,macAddress:null,duplex:null,vendor:null,mbit:null,connected:null}),t=0;t<i.list.length;t+=1)n=i.list[t],n.deviceName===r[e].physicalDev&&Ext.apply(r[e],{deviceName:n.deviceName,macAddress:n.macAddress,duplex:n.duplex,vendor:n.vendor,mbit:n.mbit,connected:n.connected});a.getStore("interfaces").reload()})},onInterfaces:function(e){console.log("load interf");var t=this,i=this.getViewModel();i.setFormulas({si:{bind:{bindTo:"{interfacesGrid.selection}",deep:!0},get:function(e){return e&&(t.getInterfaceStatus(e.get("symbolicDev")),t.getInterfaceArp(e.get("symbolicDev"))),e}}})},getInterface:function(e){return e},getInterfaceStatus:function(e){var t=this.getViewModel(),i="ifconfig "+e+' | grep "Link\\|packets" | grep -v inet6 | tr "\\n" " " | tr -s " " ',n="ifconfig "+e+' | grep "inet addr" | tr -s " " | cut -c 7- ',a="ifconfig "+e+' | grep inet6 | grep Global | cut -d" " -f 13',r={device:e,macAddress:null,address:null,mask:null,v6Addr:null,rxpkts:null,rxerr:null,rxdrop:null,txpkts:null,txerr:null,txdrop:null};rpc.execManager.execOutput(function(e,i){if(!(Ext.isEmpty(e)||e.search("Device not found")>=0)){var d=e.split(" ");e.search("Ethernet")>=0&&Ext.apply(r,{macAddress:d[4],rxpkts:d[6].split(":")[1],rxerr:d[7].split(":")[1],rxdrop:d[8].split(":")[1],txpkts:d[12].split(":")[1],txerr:d[13].split(":")[1],txdrop:d[14].split(":")[1]}),e.search("Point-to-Point")>=0&&Ext.apply(r,{macAddress:"",rxpkts:d[5].split(":")[1],rxerr:d[6].split(":")[1],rxdrop:d[7].split(":")[1],txpkts:d[11].split(":")[1],txerr:d[12].split(":")[1],txdrop:d[13].split(":")[1]}),rpc.execManager.execOutput(function(e,i){if(!Ext.isEmpty(e)){var n=e.split(" ");Ext.apply(r,{address:n[0].split(":")[1],mask:n[2].split(":")[1]}),rpc.execManager.execOutput(function(e,i){Ext.apply(r,{v6Addr:e}),t.set("siStatus",r)},a)}},n)}},i)},getInterfaceArp:function(e){var t=this.getViewModel(),i="arp -n | grep "+e+" | grep -v incomplete > /tmp/arp.txt ; cat /tmp/arp.txt";rpc.execManager.execOutput(function(e,i){for(var n,a=Ext.isEmpty(e)?[]:e.split("\n"),r=[],d=0;d<a.length;d++)Ext.isEmpty(a[d])||(n=a[d].split(/\s+/),r.push({address:n[0],type:n[1],macAddress:n[2]}));t.set("siArp",r)},i)},editWin:function(){},refreshRoutes:function(){var e=this.getView();rpc.execManager.exec(function(t,i){e.down("#currentRoutes").setValue(t.output)},"/usr/share/untangle/bin/ut-routedump.sh")},refreshQosStatistics:function(){rpc.execManager.execOutput(function(e,t){console.log(e);try{}catch(e){}},"/usr/share/untangle-netd/bin/qos-service.py status")},networkTestRender:function(e){e.down("form").insert(0,e.commandFields)},runTest:function(e){console.log(e);var t=e.up("networktest"),i=t.down("textarea"),n=[],a=this;e.setDisabled(!0),n.push(i.getValue()),n.push(""+new Date+" - "+"Test Started".t()+"\n"),rpc.execManager.execEvil(function(t,r){a.readOutput(t,n,i,e)},t.getViewModel().get("command"))},readOutput:function(e,t,i,n){var a=this;e&&e.readFromOutput(function(r,d){null!==r?(t.push(r),Ext.Function.defer(a.readOutput,1e3,a,[e,t,i,n])):(n.setDisabled(!1),t.push(""+new Date+" - "+"Test Completed".t()),t.push("\n\n--------------------------------------------------------\n\n")),i.setValue(t.join("")),i.getEl().down("textarea").dom.scrollTop=99999})},clearOutput:function(e){var t=e.up("networktest");t.down("textarea").setValue("")}}),Ext.define("Ung.config.network.NetworkModel",{extend:"Ext.app.ViewModel",alias:"viewmodel.config.network",formulas:{isAddressed:function(e){return"ADDRESSED"===e("si.configType")},isDisabled:function(e){return"DISABLED"===e("si.configType")},isBridged:function(e){return"BRIDGED"===e("si.configType")},isStaticv4:function(e){return"STATIC"===e("si.v4ConfigType")},isAutov4:function(e){return"AUTO"===e("si.v4ConfigType")},isPPPOEv4:function(e){return"PPPOE"===e("si.v4ConfigType")},isDisabledv6:function(e){return"DISABLED"===e("si.v6ConfigType")},isStaticv6:function(e){return"STATIC"===e("si.v6ConfigType")},isAutov6:function(e){return"AUTO"===e("si.v6ConfigType")},showRouterWarning:function(e){return 64!==e("si.v6StaticPrefixLength")},showWireless:function(e){return e("si.isWirelessInterface")&&"DISABLED"!==e("si.configType")},showWirelessPassword:function(e){return"NONE"!==e("si.wirelessEncryption")&&null!==e("si.wirelessEncryption")},activePropsItem:function(e){return"DISABLED"!==e("si.configType")?0:2},fullHostName:function(e){var t=e("settings.domainName"),i=e("settings.hostName");return null!==t&&""!==t?i+"."+t:i},qosPriorityNoDefaultStore:function(e){return e("qosPriorityStore").slice(1)}},data:{settings:null,siStatus:null,siArp:null,qosPriorityStore:[[0,"Default".t()],[1,"Very High".t()],[2,"High".t()],[3,"Medium".t()],[4,"Low".t()],[5,"Limited".t()],[6,"Limited More".t()],[7,"Limited Severely".t()]]},stores:{interfaces:{data:"{settings.interfaces.list}"},interfaceArp:{data:"{siArp}"},portForwardRules:{data:"{settings.portForwardRules.list}"},natRules:{data:"{settings.natRules.list}"},bypassRules:{data:"{settings.bypassRules.list}"},staticRoutes:{data:"{settings.staticRoutes.list}"},staticDnsEntries:{data:"{settings.dnsSettings.staticEntries.list}"},localServers:{data:"{settings.dnsSettings.localServers.list}"},staticDhcpEntries:{data:"{settings.staticDhcpEntries.list}"},devices:{data:"{settings.devices.list}"},qosPriorities:{data:"{settings.qosSettings.qosPriorities.list}"},qosRules:{data:"{settings.qosSettings.qosRules.list}"},forwardFilterRules:{data:"{settings.forwardFilterRules.list}"},inputFilterRules:{data:"{settings.inputFilterRules.list}"},upnpRules:{data:"{settings.upnpSettings.upnpRules.list}"},wanInterfaces:{source:"{interfaces}",filters:[{property:"configType",value:"ADDRESSED"},{property:"isWan",value:!0}]}}}),Ext.define("Ung.config.network.NetworkTest",{extend:"Ext.panel.Panel",xtype:"ung.config.networktest",alias:"widget.networktest",layout:"fit",dockedItems:[{xtype:"toolbar",layout:"fit",items:[{xtype:"container",layout:{type:"vbox",align:"stretch"},items:[{xtype:"component",padding:"10 10 0 10",bind:{html:"{description}"}},{xtype:"form",border:!1,layout:{type:"hbox"},padding:10,bodyStyle:{background:"transparent"},items:[{xtype:"button",text:"Run Test".t(),iconCls:"fa fa-play",margin:"0 0 0 10",handler:"runTest",formBind:!0},{xtype:"component",flex:1},{xtype:"button",text:"Clear Output".t(),iconCls:"fa fa-eraser",margin:"0 0 0 10",handler:"clearOutput"}]}]}]}],items:[{xtype:"textarea",border:!1,bind:{emptyText:"{emptyText}"},fieldStyle:{fontFamily:"Courier, monospace",fontSize:"14px",background:"#1b1e26",color:"lime"},readOnly:!0}]}),Ext.define("Ung.config.network.view.Advanced",{extend:"Ext.panel.Panel",alias:"widget.config.network.advanced",viewModel:!0,title:"Advanced".t(),layout:"fit",tbar:[{xtype:"displayfield",padding:"0 10",value:'<i class="fa fa-exclamation-triangle" style="color: red;"></i> '+"Advanced settings require careful configuration. Misconfiguration can compromise the proper operation and security of your server.".t()}],items:[{xtype:"tabpanel",items:[{title:"Options".t(),padding:10,defaults:{xtype:"checkbox"},items:[{boxLabel:"Enable SIP NAT Helper".t(),bind:"{settings.enableSipNatHelper}"},{boxLabel:"Send ICMP Redirects".t(),bind:"{settings.sendIcmpRedirects}"},{boxLabel:"Enable STP (Spanning Tree) on Bridges".t(),bind:"{settings.stpEnabled}"},{boxLabel:"Enable Strict ARP mode".t(),bind:"{settings.strictArpMode}"},{boxLabel:"DHCP Authoritative".t(),bind:"{settings.dhcpAuthoritative}"},{boxLabel:"Block new sessions during network configuration".t(),bind:"{settings.blockDuringRestarts}"},{boxLabel:"Block replay packets".t(),bind:"{settings.blockReplayPackets}"},{boxLabel:"Log bypassed sessions".t(),bind:"{settings.logBypassedSessions}"},{boxLabel:"Log local outbound sessions".t(),bind:"{settings.logLocalOutboundSessions}"},{boxLabel:"Log local inbound sessions".t(),bind:"{settings.logLocalInboundSessions}"},{boxLabel:"Log blocked sessions".t(),bind:"{settings.logBlockedSessions}"},{boxLabel:"Log intermediate session updates".t(),bind:"{settings.logSessionUpdates}"}]},{title:"QoS".t(),layout:"fit",dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"checkbox",fieldLabel:"Enabled".t(),labelAlign:"right",bind:"{settings.qosSettings.qosEnabled}"},{xtype:"combo",fieldLabel:"Default Priority".t(),labelAlign:"right",bind:{store:"{qosPriorityNoDefaultStore}",value:"{settings.qosSettings.defaultPriority}",disabled:"{!settings.qosSettings.qosEnabled}"},queryMode:"local",editable:!1}]}],items:[{xtype:"tabpanel",layout:"fit",disabled:!0,bind:{disabled:"{!settings.qosSettings.qosEnabled}"},items:[{xtype:"grid",title:"WAN Bandwidth".t(),tbar:[{xtype:"component",padding:5,html:Ext.String.format("{0}Note{1}: When enabling QoS valid Download Bandwidth and Upload Bandwidth limits must be set for all WAN interfaces.".t(),'<font color="red">',"</font>")+"<br/>"}],listProperty:"settings.interfaces.list",bind:"{wanInterfaces}",selModel:{type:"cellmodel"},plugins:{ptype:"cellediting",clicksToEdit:1},header:!1,sortableColumns:!1,enableColumnHide:!1,columns:[{header:"Id".t(),width:70,align:"right",dataIndex:"interfaceId"},{header:"WAN".t(),flex:1,dataIndex:"name"},{header:"Config Type".t(),dataIndex:"configType",width:150},{header:"Download Bandwidth".t(),dataIndex:"downloadBandwidthKbps",width:250,editor:{xtype:"numberfield",allowBlank:!0,allowDecimals:!1,minValue:0},renderer:function(e){return Ext.isEmpty(e)?"Not set".t():e+" kbps ("+e/1e3+" Mbit)"}},{header:"Upload Bandwidth".t(),dataIndex:"uploadBandwidthKbps",width:250,editor:{xtype:"numberfield",allowBlank:!0,allowDecimals:!1,minValue:0},renderer:function(e){return Ext.isEmpty(e)?"Not set".t():e+" kbps ("+e/1e3+" Mbit)"}}]},{xtype:"panel",title:"QoS Rules".t(),layout:{type:"vbox",align:"stretch"},items:[{border:!1,defaults:{xtype:"combo",labelAlign:"top",labelWidth:120,editable:!1,queryMode:"local",padding:10},layout:{type:"hbox",align:"stretch"},items:[{fieldLabel:"Ping Priority".t(),bind:{store:"{qosPriorityStore}",value:"{settings.qosSettings.pingPriority}"}},{fieldLabel:"DNS Priority".t(),bind:{store:"{qosPriorityStore}",value:"{settings.qosSettings.dnsPriority}"}},{fieldLabel:"SSH Priority".t(),bind:{store:"{qosPriorityStore}",value:"{settings.qosSettings.sshPriority}"}},{fieldLabel:"OpenVPN Priority".t(),bind:{store:"{qosPriorityStore}",value:"{settings.qosSettings.openvpnPriority}"}}]},{xtype:"rules",title:"QoS Custom Rules".t(),border:!1,columnFeatures:["reorder","delete","edit"],recordActions:["@edit","@delete"],listProperty:"settings.qosSettings.qosRules.list",conditions:[{name:"DST_LOCAL",displayName:"Destined Local".t(),type:"boolean",visible:!0},{name:"DST_ADDR",displayName:"Destination Address".t(),type:"textfield",visible:!0,vtype:"ipall"},{name:"DST_PORT",displayName:"Destination Port".t(),type:"textfield",vtype:"port",visible:!0},{name:"SRC_ADDR",displayName:"Source Address".t(),type:"textfield",visible:!0,vtype:"ipall"},{name:"SRC_PORT",displayName:"Source Port".t(),type:"numberfield",vtype:"port",visible:rpc.isExpertMode},{name:"SRC_INTF",displayName:"Source Interface".t(),type:"checkboxgroup",values:[["a","a"],["b","b"]],visible:!0},{name:"PROTOCOL",displayName:"Protocol".t(),type:"checkboxgroup",values:[["TCP","TCP"],["UDP","UDP"],["ICMP","ICMP"],["GRE","GRE"],["ESP","ESP"],["AH","AH"],["SCTP","SCTP"]],visible:!0}],label:"Perform the following action(s):".t(),tbar:[{xtype:"component",padding:5,html:Ext.String.format("{0}Note{1}: Custom Rules only match <b>Bypassed</b> traffic.".t(),'<font color="red">',"</font>")}],bind:"{qosRules}",columns:[{header:"Rule Id".t(),width:70,align:"right",resizable:!1,dataIndex:"ruleId",renderer:function(e){return e<0?"new".t():e}},{xtype:"checkcolumn",header:"Enable".t(),dataIndex:"enabled",resizable:!1,width:70,editor:{xtype:"checkbox",fieldLabel:"Enable".t(),bind:"{record.enabled}"}},{header:"Description",width:200,dataIndex:"description",renderer:function(e){return e?e:"<em>no description<em>"},editor:{xtype:"textfield",fieldLabel:"Description".t(),bind:"{record.description}",emptyText:"[no description]".t(),allowBlank:!1}},{header:"Conditions".t(),itemId:"conditions",flex:1,dataIndex:"conditions",renderer:"conditionsRenderer"},{header:"Priority".t(),width:100,dataIndex:"priority",renderer:function(e){switch(e){case 1:return"Very High".t();case 2:return"High".t();case 3:return"Medium".t();case 4:return"Low".t();case 5:return"Limited".t();case 6:return"Limited More".t();case 7:return"Limited Severely".t()}},editor:{xtype:"combo",fieldLabel:"Priority".t(),store:[[1,"Very High".t()],[2,"High".t()],[3,"Medium".t()],[4,"Low".t()],[5,"Limited".t()],[6,"Limited More".t()],[7,"Limited Severely".t()]],bind:"{record.priority}",queryMode:"local",editable:!1}}]}]},{xtype:"grid",title:"QoS Priorities".t(),bind:"{qosPriorities}",selModel:{type:"cellmodel"},plugins:{ptype:"cellediting",clicksToEdit:1},columnLines:!0,sortableColumns:!1,enableColumnHide:!1,columns:[{header:"Priority".t(),width:150,align:"right",dataIndex:"priorityName",renderer:function(e){return e.t()}},{header:"Upload Reservation".t(),dataIndex:"uploadReservation",width:150,editor:{xtype:"numberfield",allowBlank:!1,minValue:.1,maxValue:100},renderer:function(e,t,i){return 0===e?"No reservation":e+"%"}},{header:"Upload Limit".t(),dataIndex:"uploadLimit",width:150,editor:{xtype:"numberfield",allowBlank:!1,minValue:.1,maxValue:100},renderer:function(e,t,i){return 0===e?"No reservation":e+"%"}},{header:"Download Reservation".t(),dataIndex:"downloadReservation",width:150,editor:{xtype:"numberfield",allowBlank:!1,minValue:.1,maxValue:100},renderer:function(e,t,i){return 0===e?"No reservation":e+"%"}},{header:"Download Limit".t(),dataIndex:"downloadLimit",width:150,editor:{xtype:"numberfield",allowBlank:!1,minValue:.1,maxValue:100},renderer:function(e,t,i){return 0===e?"No limit":e+"%"}},{flex:1}]},{xtype:"grid",title:"QoS Statistics".t(),groupField:"interface_name",columnLines:!0,enableColumnHide:!1,tbar:[{text:"Refresh".t(),iconCls:"fa fa-refresh",handler:"refreshQosStatistics"}],columns:[{header:"Interface".t(),width:150,dataIndex:"interface_name",renderer:function(e){return e.t()}},{header:"Priority".t(),dataIndex:"priority",width:150},{header:"Data".t(),dataIndex:"sent",width:150},{flex:1}]}]}]},{title:"Filter Rules".t(),layout:"border",items:[{xtype:"rules",region:"center",title:"Forward Filter Rules".t(),columnFeatures:["reorder","delete","edit"],recordActions:["@edit","@delete"],listProperty:"settings.forwardFilterRules.list",label:"Perform the following action(s):".t(),conditions:[{name:"DST_LOCAL",displayName:"Destined Local".t(),type:"boolean",visible:!0},{name:"DST_ADDR",displayName:"Destination Address".t(),type:"textfield",visible:!0,vtype:"ipall"},{name:"DST_PORT",displayName:"Destination Port".t(),type:"textfield",vtype:"port",visible:!0},{name:"SRC_MAC",displayName:"Source MAC".t(),type:"textfield",visible:!0},{name:"SRC_ADDR",displayName:"Source Address".t(),type:"textfield",visible:!0,vtype:"ipall"},{name:"SRC_PORT",displayName:"Source Port".t(),type:"textfield",vtype:"port",visible:rpc.isExpertMode},{name:"PROTOCOL",displayName:"Protocol".t(),type:"checkboxgroup",values:[["TCP","TCP"],["UDP","UDP"],["ICMP","ICMP"],["GRE","GRE"],["ESP","ESP"],["AH","AH"],["SCTP","SCTP"]],visible:!0}],emptyRow:{ruleId:-1,enabled:!0,ipvsEnabled:!1,description:"",javaClass:"com.untangle.uvm.network.FilterRule",conditions:{javaClass:"java.util.LinkedList",list:[]},blocked:!1},bind:"{forwardFilterRules}",columns:[{header:"Rule Id".t(),width:70,align:"right",resizable:!1,dataIndex:"ruleId",renderer:function(e){return e<0?"new".t():e}},{xtype:"checkcolumn",header:"Enable".t(),dataIndex:"enabled",resizable:!1,width:70,editor:{xtype:"checkbox",fieldLabel:"Enable Forward Filter Rule".t(),bind:"{record.enabled}"}},{xtype:"checkcolumn",header:"IPv6".t(),dataIndex:"ipv6Enabled",resizable:!1,width:70,editor:{xtype:"checkbox",fieldLabel:"Enable IPv6 Support".t(),bind:"{record.ipv6Enabled}"}},{header:"Description",width:200,dataIndex:"description",renderer:function(e){return e||"<em>no description<em>"},editor:{xtype:"textfield",fieldLabel:"Description".t(),bind:"{record.description}",emptyText:"[no description]".t(),allowBlank:!1}},{header:"Conditions".t(),itemId:"conditions",flex:1,dataIndex:"conditions",renderer:"conditionsRenderer"},{xtype:"checkcolumn",header:"Block".t(),dataIndex:"blocked",resizable:!1,width:70,editor:{xtype:"combo",fieldLabel:"Action".t(),bind:"{record.blocked}",editable:!1,store:[[!0,"Block".t()],[!1,"Pass".t()]],queryMode:"local"}}]},{xtype:"rules",region:"south",height:"60%",split:!0,title:"Input Filter Rules".t(),columnFeatures:["reorder","delete","edit"],recordActions:["@edit","@delete"],listProperty:"settings.inputFilterRules.list",label:"Perform the following action(s):".t(),conditions:[{name:"DST_LOCAL",displayName:"Destined Local".t(),type:"boolean",visible:!0},{name:"DST_ADDR",displayName:"Destination Address".t(),type:"textfield",visible:!0,vtype:"ipall"},{name:"DST_PORT",displayName:"Destination Port".t(),type:"textfield",vtype:"port",visible:!0},{name:"DST_INTF",displayName:"Destination Interface".t(),type:"checkgroup",values:[],visible:!0},{name:"SRC_MAC",displayName:"Source MAC".t(),type:"textfield",visible:!0},{name:"SRC_ADDR",displayName:"Source Address".t(),type:"textfield",visible:!0,vtype:"ipall"},{name:"SRC_PORT",displayName:"Source Port".t(),type:"textfield",vtype:"port",visible:rpc.isExpertMode},{name:"SRC_INTF",displayName:"Source Interface".t(),type:"checkgroup",values:[],visible:!0},{name:"PROTOCOL",displayName:"Protocol".t(),type:"checkboxgroup",values:[["TCP","TCP"],["UDP","UDP"],["ICMP","ICMP"],["GRE","GRE"],["ESP","ESP"],["AH","AH"],["SCTP","SCTP"]],visible:!0}],emptyRow:{ruleId:-1,enabled:!0,ipvsEnabled:!1,description:"",javaClass:"com.untangle.uvm.network.FilterRule",conditions:{javaClass:"java.util.LinkedList",list:[]},blocked:!1,readOnly:null},bind:"{inputFilterRules}",columns:[{header:"Rule Id".t(),width:70,align:"right",resizable:!1,dataIndex:"ruleId",renderer:function(e){return e<0?"new".t():e}},{xtype:"checkcolumn",header:"Enable".t(),dataIndex:"enabled",resizable:!1,width:70,editor:{xtype:"checkbox",fieldLabel:"Enable Forward Filter Rule".t(),bind:"{record.enabled}"}},{xtype:"checkcolumn",header:"IPv6".t(),dataIndex:"ipv6Enabled",resizable:!1,width:70,editor:{xtype:"checkbox",fieldLabel:"Enable IPv6 Support".t(),bind:"{record.ipv6Enabled}"}},{header:"Description",width:200,dataIndex:"description",renderer:function(e){return e||"<em>no description<em>"},editor:{xtype:"textfield",fieldLabel:"Description".t(),bind:"{record.description}",emptyText:"[no description]".t(),allowBlank:!1}},{header:"Conditions".t(),itemId:"conditions",flex:1,dataIndex:"conditions",renderer:"conditionsRenderer"},{xtype:"checkcolumn",header:"Block".t(),dataIndex:"blocked",resizable:!1,width:70,editor:{xtype:"combo",fieldLabel:"Action".t(),bind:"{record.blocked}",editable:!1,store:[[!0,"Block".t()],[!1,"Pass".t()]],queryMode:"local"}}]}]},{title:"UPnP".t(),layout:"border",dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"checkbox",fieldLabel:"Enabled".t(),labelAlign:"right",bind:"{settings.upnpSettings.upnpEnabled}"},{xtype:"checkbox",fieldLabel:"Secure Mode".t(),labelAlign:"right",bind:{value:"{settings.upnpSettings.secureMode}",disabled:"{!settings.upnpSettings.upnpEnabled}"}}]}],items:[{xtype:"grid",region:"center",title:"Status".t(),enableColumnHide:!1,enableSorting:!1,tbar:[{text:"Refresh".t(),iconCls:"fa fa-refresh"}],disabled:!0,bind:{disabled:"{!settings.upnpSettings.upnpEnabled}"},columns:[{header:"Protocol".t(),width:100,dataIndex:"upnp_protocol"},{header:"Client IP Address".t(),width:150,dataIndex:"upnp_client_ip_address"},{header:"Client Port".t(),width:150,dataIndex:"upnp_client_port"},{header:"Destination Port".t(),width:150,dataIndex:"upnp_destination_port"},{header:"Bytes".t(),width:150,dataIndex:"bytes"}]},{xtype:"rules",region:"south",height:"50%",split:!0,title:"Access Control Rules".t(),columnFeatures:["reorder","delete","edit"],recordActions:["@edit","@delete"],listProperty:"settings.upnpSettings.upnpRules.list",conditions:[{name:"DST_PORT",displayName:"Destination Port".t(),type:"textfield",vtype:"port",visible:!0},{name:"SRC_ADDR",displayName:"Source Address".t(),type:"textfield",visible:!0,vtype:"ipall"},{name:"SRC_PORT",displayName:"Source Port".t(),type:"textfield",vtype:"port",visible:!0}],label:"Perform the following action(s):".t(),emptyRow:{ruleId:-1,enabled:!0,javaClass:"com.untangle.uvm.network.UpnpRule",conditions:{javaClass:"java.util.LinkedList",list:[]},priority:1},disabled:!0,bind:{store:"{upnpRules}",disabled:"{!settings.upnpSettings.upnpEnabled}"},columns:[{header:"Rule Id".t(),width:70,align:"right",resizable:!1,dataIndex:"ruleId",renderer:function(e){return e<0?"new".t():e}},{xtype:"checkcolumn",header:"Enable".t(),dataIndex:"enabled",resizable:!1,width:70,editor:{xtype:"checkbox",fieldLabel:"Enable".t(),bind:"{record.enabled}"}},{header:"Description",width:200,dataIndex:"description",renderer:function(e){return e||"<em>no description<em>"},editor:{xtype:"textfield",fieldLabel:"Description".t(),bind:"{record.description}",emptyText:"[no description]".t(),allowBlank:!1}},{header:"Conditions".t(),itemId:"conditions",flex:1,dataIndex:"conditions",renderer:"conditionsRenderer"},{header:"Action".t(),width:100,dataIndex:"allow",renderer:function(e){return e?"Allow".t():"Deny".t()},editor:{xtype:"combo",bind:"{record.allow}",store:[[!1,"Deny".t()],[!0,"Allow".t()]],queryMode:"local",editable:!1}}]}]},{title:"DNS & DHCP".t(),xtype:"panel",tbar:[{xtype:"displayfield",padding:"0 10",value:"<strong>"+"Custom dnsmasq options.".t()+'</strong> <i class="fa fa-exclamation-triangle" style="color: red;"></i> '+"Warning: Invalid syntax will halt all DHCP & DNS services.".t()}],layout:"fit",items:[{xtype:"textarea",margin:10,fieldStyle:{fontFamily:"monospace"},bind:"{settings.dnsmasqOptions}"}]},{xtype:"grid",title:"Network Cards".t(),bind:"{devices}",selModel:{type:"cellmodel"},plugins:{ptype:"cellediting",clicksToEdit:1},columns:[{header:"Device Name".t(),width:250,dataIndex:"deviceName"},{header:"MTU".t(),width:100,dataIndex:"mtu",renderer:function(e){return e||"Auto".t()},editor:{xtype:"numberfield"}},{header:"Ethernet Media".t(),dataIndex:"duplex",width:250,renderer:function(e){switch(e){case"AUTO":return"Auto".t();case"M10000_FULL_DUPLEX":return"10000 Mbps, Full Duplex".t();case"M10000_HALF_DUPLEX":return"10000 Mbps, Half Duplex".t();case"M1000_FULL_DUPLEX":return"1000 Mbps, Full Duplex".t();case"M1000_HALF_DUPLEX":return"1000 Mbps, Half Duplex".t();case"M100_FULL_DUPLEX":return"100 Mbps, Full Duplex".t();case"M100_HALF_DUPLEX":return"100 Mbps, Half Duplex".t();case"M10_FULL_DUPLEX":return"10 Mbps, Full Duplex".t();case"M10_HALF_DUPLEX":return"10 Mbps, Half Duplex".t()}},editor:{xtype:"combo",store:[["AUTO","Auto".t()],["M10000_FULL_DUPLEX","10000 Mbps, Full Duplex".t()],["M10000_HALF_DUPLEX","10000 Mbps, Half Duplex".t()],["M1000_FULL_DUPLEX","1000 Mbps, Full Duplex".t()],["M1000_HALF_DUPLEX","1000 Mbps, Half Duplex".t()],["M100_FULL_DUPLEX","100 Mbps, Full Duplex".t()],["M100_HALF_DUPLEX","100 Mbps, Half Duplex".t()],["M10_FULL_DUPLEX","10 Mbps, Full Duplex".t()],["M10_HALF_DUPLEX","10 Mbps, Half Duplex".t()]],queryMode:"local",editable:!1}},{flex:1}]}]}]}),Ext.define("Ung.config.network.view.BypassRules",{extend:"Ext.panel.Panel",alias:"widget.config.network.bypassrules",viewModel:!0,requires:[],title:"Bypass Rules".t(),layout:"fit",tbar:[{xtype:"displayfield",padding:"0 10",value:"Bypass Rules control what traffic is scanned by the applications. Bypassed traffic skips application processing. The rules are evaluated in order. Sessions that meet no rule are not bypassed.".t()}],items:[{xtype:"rules",flex:3,columnFeatures:["reorder","delete","edit"],recordActions:["@edit","@delete"],listProperty:"settings.bypassRules.list",ruleJavaClass:"com.untangle.uvm.network.BypassRuleCondition",conditions:[{name:"DST_ADDR",displayName:"Destination Address".t(),type:"textfield",visible:!0,vtype:"ipall"},{name:"DST_PORT",displayName:"Destination Port".t(),type:"textfield",vtype:"port",visible:!0},{name:"DST_INTF",displayName:"Destination Interface".t(),type:"checkboxgroup",values:[["a","a"],["b","b"]],visible:!0},{name:"SRC_ADDR",displayName:"Source Address".t(),type:"textfield",visible:!0,vtype:"ipall"},{name:"SRC_PORT",displayName:"Source Port".t(),type:"numberfield",vtype:"port",visible:rpc.isExpertMode},{name:"SRC_INTF",displayName:"Source Interface".t(),type:"checkboxgroup",values:[["a","a"],["b","b"]],visible:!0},{name:"PROTOCOL",displayName:"Protocol".t(),type:"checkboxgroup",values:[["TCP","TCP"],["UDP","UDP"],["ICMP","ICMP"],["GRE","GRE"],["ESP","ESP"],["AH","AH"],["SCTP","SCTP"]],visible:!0}],label:"Perform the following action(s):".t(),description:"NAT Rules control the rewriting of the IP source address of traffic (Network Address Translation). The rules are evaluated in order.".t(),emptyRow:{ruleId:-1,enabled:!0,bypass:!0,javaClass:"com.untangle.uvm.network.BypassRule",conditions:{javaClass:"java.util.LinkedList",list:[]},description:""},bind:"{bypassRules}",columns:[{header:"Rule Id".t(),width:70,align:"right",resizable:!1,dataIndex:"ruleId",renderer:function(e){return e<0?"new".t():e}},{xtype:"checkcolumn",header:"Enable".t(),dataIndex:"enabled",resizable:!1,width:70,editor:{xtype:"checkbox",fieldLabel:"Enable NAT Rule".t(),bind:"{record.enabled}"}},{header:"Description",width:200,dataIndex:"description",renderer:function(e){return e?e:"<em>no description<em>"},editor:{xtype:"textfield",fieldLabel:"Description".t(),bind:"{record.description}",emptyText:"[no description]".t(),allowBlank:!1}},{header:"Conditions".t(),itemId:"conditions",flex:1,dataIndex:"conditions",renderer:"conditionsRenderer"},{header:"Bypass".t(),xtype:"checkcolumn",dataIndex:"bypass",width:100,editor:{xtype:"combo",fieldLabel:"Action".t(),bind:"{record.bypass}",editable:!1,store:[[!0,"Bypass".t()],[!1,"Process".t()]],queryMode:"local"}}]}]}),Ext.define("Ung.config.network.view.DhcpServer",{extend:"Ext.panel.Panel",alias:"widget.config.network.dhcpserver",viewModel:!0,title:"DHCP Server".t(),layout:"border",items:[{xtype:"rules",region:"center",title:"Static DHCP Entries".t(),columnFeatures:["delete"],recordActions:["@delete"],listProperty:"settings.staticRoutes.list",bind:"{staticDhcpEntries}",columns:[{header:"MAC Address".t(),dataIndex:"macAddress",width:200,editor:{xtype:"textfield",allowBlank:!1,emptyText:"[enter MAC name]".t(),maskRe:/[a-fA-F0-9:]/}},{header:"Address".t(),flex:1,dataIndex:"address",editor:{xtype:"textfield",emptyText:"[enter address]".t(),allowBlank:!1,vtype:"ipall"}},{header:"Description".t(),width:200,dataIndex:"description",editor:{xtype:"textfield",emptyText:"[enter description]".t(),allowBlank:!1}}]},{xtype:"grid",title:"Current DHCP Leases".t(),region:"south",height:"50%",split:!0,tbar:[{text:"Refresh".t(),iconCls:"fa fa-refresh"}],columns:[{header:"MAC Address".t(),dataIndex:"macAddress",width:150},{header:"Address".t(),dataIndex:"address",width:200},{header:"Hostname".t(),dataIndex:"hostname",width:200},{header:"Expiration Time".t(),dataIndex:"date",width:180},{xtype:"actioncolumn",header:"Add Static".t(),iconCls:"fa fa-plus",handler:function(){alert("to add")}}]}]}),Ext.define("Ung.config.network.view.DnsServer",{extend:"Ext.panel.Panel",alias:"widget.config.network.dnsserver",viewModel:!0,title:"DNS Server".t(),layout:"border",items:[{xtype:"rules",region:"center",title:"Static DNS Entries".t(),columnFeatures:["delete"],recordActions:["@delete"],listProperty:"settings.dnsSettings.staticEntries.list",bind:"{staticDnsEntries}",columns:[{header:"Name".t(),dataIndex:"name",flex:1,editor:{xtype:"textfield",allowBlank:!1,emptyText:"[enter name]".t()}},{header:"Address".t(),width:200,dataIndex:"address",editor:{xtype:"textfield",emptyText:"[enter address]".t(),allowBlank:!1,vtype:"ipall"}}]},{xtype:"rules",region:"south",height:"50%",split:!0,title:"Domain DNS Servers".t(),columnFeatures:["delete"],recordActions:["@delete"],listProperty:"settings.dnsSettings.localServers.list",bind:"{localServers}",columns:[{header:"Domain".t(),dataIndex:"domain",flex:1,editor:{xtype:"textfield",allowBlank:!1,emptyText:"[enter domain]".t()}},{header:"Server".t(),width:200,dataIndex:"localServer",editor:{xtype:"textfield",emptyText:"[enter DNS server]".t(),allowBlank:!1,vtype:"ipall"}}]}]}),Ext.define("Ung.config.network.view.Hostname",{extend:"Ext.panel.Panel",alias:"widget.config.network.hostname",viewModel:!0,title:"Hostname".t(),padding:10,items:[{xtype:"fieldset",title:"Hostname".t(),items:[{xtype:"container",layout:"column",margin:"0 0 5 0",items:[{xtype:"textfield",fieldLabel:"Hostname".t(),labelAlign:"right",emptyText:"untangle",name:"HostName",bind:"{settings.hostName}",maskRe:/[a-zA-Z0-9\-]/},{xtype:"label",html:"(eg: gateway)".t(),cls:"boxlabel"}]},{xtype:"container",layout:"column",margin:"0 0 5 0",items:[{xtype:"textfield",fieldLabel:"Domain Name".t(),labelAlign:"right",emptyText:"example.com",allowBlank:!1,name:"DomainName",bind:"{settings.domainName}"},{xtype:"label",html:"(eg: example.com)",
cls:"boxlabel"}]}]},{xtype:"fieldset",title:"Dynamic DNS Service Configuration".t(),defaults:{labelAlign:"right"},items:[{xtype:"checkbox",fieldLabel:"Enabled",bind:"{settings.dynamicDnsServiceEnabled}"},{xtype:"combo",fieldLabel:"Service".t(),bind:"{settings.dynamicDnsServiceName}",store:[["easydns","EasyDNS"],["zoneedit","ZoneEdit"],["dyndns","DynDNS"],["namecheap","Namecheap"],["dslreports","DSL-Reports"],["dnspark","DNSPark"],["no-ip","No-IP"],["dnsomatic","DNS-O-Matic"],["cloudflare","Cloudflare"]]},{xtype:"textfield",fieldLabel:"Username".t(),bind:"{settings.dynamicDnsServiceUsername}"},{xtype:"textfield",fieldLabel:"Password".t(),bind:"{settings.dynamicDnsServicePassword}",inputType:"password"},{xtype:"textfield",fieldLabel:"Hostname(s)".t(),bind:"{settings.dynamicDnsServiceHostnames}"}]},{xtype:"radiogroup",title:"Public Address Configuration".t(),columns:1,simpleValue:!0,bind:"{settings.publicUrlMethod}",items:[{xtype:"component",margin:"0 0 10 0",html:Ext.String.format("The Public Address is the address/URL that provides a public location for the {0} Server. This address will be used in emails sent by the {0} Server to link back to services hosted on the {0} Server such as Quarantine Digests and OpenVPN Client emails.".t(),rpc.companyName)},{xtype:"radio",boxLabel:"Use IP address from External interface (default)".t(),name:"publicUrl",inputValue:"external"},{xtype:"component",margin:"0 0 10 25",html:Ext.String.format("This works if your {0} Server has a routable public static IP address.".t(),rpc.companyName)},{xtype:"radio",boxLabel:"Use Hostname".t(),name:"publicUrl",inputValue:"hostname"},{xtype:"component",margin:"0 0 5 25",html:Ext.String.format("This is recommended if the {0} Server's fully qualified domain name looks up to its IP address both internally and externally.".t(),rpc.companyName)},{xtype:"component",margin:"0 0 10 25",bind:{html:"Current Hostname".t()+":<i> {fullHostName} </i>"}},{xtype:"radio",boxLabel:"Use Manually Specified Address".t(),name:"publicUrl",inputValue:"address_and_port"},{xtype:"component",margin:"0 0 10 25",html:Ext.String.format("This is recommended if the {0} Server is installed behind another firewall with a port forward from the specified hostname/IP that redirects traffic to the {0} Server.".t(),rpc.companyName)},{xtype:"textfield",margin:"0 0 5 25",fieldLabel:"IP/Hostname".t(),name:"publicUrlAddress",allowBlank:!1,width:400,blankText:"You must provide a valid IP Address or hostname.".t(),disabled:!0,bind:{value:"{settings.publicUrlAddress}",disabled:'{settings.publicUrlMethod != "address_and_port"}'}},{xtype:"numberfield",margin:"0 0 5 25",fieldLabel:"Port".t(),name:"publicUrlPort",allowDecimals:!1,minValue:0,allowBlank:!1,width:210,blankText:"You must provide a valid port.".t(),vtype:"port",disabled:!0,bind:{value:"{settings.publicUrlPort}",disabled:'{settings.publicUrlMethod != "address_and_port"}'}}]}]}),Ext.define("Ung.config.network.view.Interfaces",{extend:"Ext.panel.Panel",alias:"widget.config.network.interfaces",title:"Interfaces".t(),layout:"border",itemId:"interfaces",tbar:[{xtype:"displayfield",value:"Use this page to configure each interface's configuration and its mapping to a physical network card.".t()}],items:[{xtype:"grid",itemId:"interfacesGrid",reference:"interfacesGrid",region:"center",flex:1,border:!1,forceFit:!0,bind:"{interfaces}",fields:[{name:"v4Address"}],columns:[{header:"Id".t(),dataIndex:"interfaceId",width:50,align:"right"},{header:"Name".t(),dataIndex:"name",minWidth:200},{header:"Connected".t(),dataIndex:"connected",width:130,renderer:function(e){switch(e){case"CONNECTED":return"connected".t();case"DISCONNECTED":return"disconnected".t();case"MISSING":return"missing".t();default:"unknown".t()}}},{header:"Device".t(),dataIndex:"physicalDev",width:100},{header:"Speed".t(),dataIndex:"mbit",width:100},{header:"Physical Dev".t(),dataIndex:"physicalDev",hidden:!0,width:80},{header:"System Dev".t(),dataIndex:"systemDev",hidden:!0,width:80},{header:"Symbolic Dev".t(),dataIndex:"symbolicDev",hidden:!0,width:80},{header:"IMQ Dev".t(),dataIndex:"imqDev",hidden:!0,width:80},{header:"Duplex".t(),dataIndex:"duplex",hidden:!0,width:100,renderer:function(e){switch(e){case"FULL_DUPLEX":return"full-duplex".t();case"HALF_DUPLEX":return"half-duplex".t();default:return"unknown".t()}}},{header:"Config".t(),dataIndex:"configType",width:100,renderer:function(e){switch(e){case"ADDRESSED":return"Addressed".t();case"BRIDGED":return"Bridged".t();case"DISABLED":return"Disabled".t();default:e.t()}}},{header:"Current Address".t(),dataIndex:"v4Address",width:150,renderer:function(e,t,i){return Ext.isEmpty(e)?"":e+" / "+i.get("v4PrefixLength")}},{header:"is WAN".t(),dataIndex:"isWan",renderer:function(e,t,i){return"ADDRESSED"===i.get("configType")?e?"true".t():"false".t():""}}],tbar:[{xtype:"button",iconCls:"fa fa-refresh",text:"Refresh".t(),handler:"loadInterfaceStatusAndDevices"}]},{xtype:"tabpanel",region:"east",split:"true",collapsible:!1,width:450,hidden:!0,bind:{title:"{si.name} ({si.physicalDev})",hidden:"{!si}"},items:[{title:"Status".t(),itemId:"interfaceStatus",xtype:"propertygrid",hideHeaders:!0,sortableColumns:!1,align:"right",nameColumnWidth:150,bind:{source:"{siStatus}"},sourceConfig:{device:{displayName:"Device".t()},macAddress:{displayName:"MAC Address".t()},address:{displayName:"IPv4 Address".t()},mask:{displayName:"Mask".t()},v6Addr:{displayName:"IPv6".t()},rxpkts:{displayName:"Rx Packets".t()},rxerr:{displayName:"Rx Errors".t()},rxdrop:{displayName:"Rx Drop".t()},txpkts:{displayName:"Tx Packets".t()},txerr:{displayName:"Tx Errors".t()},txdrop:{displayName:"Tx Drop".t()}},tbar:[{xtype:"button",iconCls:"fa fa-refresh",text:"Refresh"}]},{xtype:"grid",itemId:"interfaceArp",title:"ARP Entry List".t(),forceFit:!0,bind:"{interfaceArp}",columns:[{header:"MAC Address".t(),dataIndex:"macAddress"},{header:"IP Address".t(),dataIndex:"address"},{header:"Type".t(),dataIndex:"type"}]},{title:"Config".t(),bodyPadding:15,scrollable:"vertical",layout:{type:"vbox",align:"stretch"},defaults:{labelWidth:200,labelAlign:"right"},items:[{xtype:"textfield",fieldLabel:"Interface Name".t(),labelAlign:"top",name:"interfaceName",allowBlank:!1,bind:"{si.name}"},{xtype:"combo",allowBlank:!1,editable:!1,bind:{value:"{si.vlanParent}",hidden:"{!si.isVlanInterface || isDisabled}"},hidden:!0,fieldLabel:"Parent Interface".t(),queryMode:"local"},{xtype:"numberfield",bind:{value:"{si.vlanTag}",hidden:"{!si.isVlanInterface || isDisabled}"},hidden:!0,fieldLabel:"802.1q Tag".t(),minValue:1,maxValue:4096,allowBlank:!1},{xtype:"segmentedbutton",allowMultiple:!1,bind:"{si.configType}",margin:"10 12",items:[{text:"Addressed".t(),value:"ADDRESSED"},{text:"Bridged".t(),value:"BRIDGED"},{text:"Disabled".t(),value:"DISABLED"}]},{xtype:"combo",allowBlank:!1,editable:!1,hidden:!0,bind:{value:"{si.bridgedTo}",hidden:"{!isBridged}"},fieldLabel:"Bridged To".t(),queryMode:"local"},{xtype:"checkbox",fieldLabel:"Is WAN Interface".t(),hidden:!0,bind:{value:"{si.isWan}",hidden:"{!isAddressed}"}},{xtype:"fieldset",width:"100%",title:"Wireless Configuration".t(),collapsible:!0,defaults:{labelWidth:190,labelAlign:"right",anchor:"100%"},hidden:!0,bind:{hidden:"{!showWireless || !isAddressed}"},items:[{xtype:"textfield",fieldLabel:"SSID".t(),bind:"{si.wirelessSsid}",allowBlank:!1,disableOnly:!0,maxLength:30,maskRe:/[a-zA-Z0-9\-_=]/},{xtype:"combo",fieldLabel:"Encryption".t(),bind:"{si.wirelessEncryption}",editable:!1,store:[["NONE","None".t()],["WPA1","WPA".t()],["WPA12","WPA / WPA2".t()],["WPA2","WPA2".t()]],queryMode:"local"},{xtype:"textfield",bind:{value:"{si.wirelessPassword}",hidden:"{!showWirelessPassword}"},fieldLabel:"Password".t(),allowBlank:!1,disableOnly:!0,maxLength:63,minLength:8,maskRe:/[a-zA-Z0-9~@#%_=,\!\-\/\?\(\)\[\]\\\^\$\+\*\.\|]/},{xtype:"combo",bind:"{si.wirelessChannel}",fieldLabel:"Channel".t(),editable:!1,valueField:"channel",displayField:"channelDescription",queryMode:"local"}]},{xtype:"fieldset",title:"IPv4 Configuration".t(),collapsible:!0,defaults:{labelWidth:190,labelAlign:"right",anchor:"100%"},hidden:!0,bind:{hidden:"{!isAddressed}"},items:[{xtype:"segmentedbutton",allowMultiple:!1,bind:{value:"{si.v4ConfigType}",hidden:"{!si.isWan}"},margin:"10 0",items:[{text:"Auto (DHCP)".t(),value:"AUTO"},{text:"Static".t(),value:"STATIC"},{text:"PPPoE".t(),value:"PPPOE"}]},{xtype:"textfield",bind:{value:"{si.v4StaticAddress}",hidden:"{!isStaticv4}"},fieldLabel:"Address".t(),allowBlank:!1},{xtype:"combo",bind:{value:"{si.v4StaticPrefix}",hidden:"{!isStaticv4}"},fieldLabel:"Netmask".t(),allowBlank:!1,editable:!1,store:Ung.Util.v4NetmaskList,queryMode:"local"},{xtype:"textfield",bind:{value:"{si.v4StaticGateway}",hidden:"{!si.isWan || !isStaticv4}"},fieldLabel:"Gateway".t(),allowBlank:!1},{xtype:"textfield",bind:{value:"{si.v4StaticDns1}",hidden:"{!si.isWan || !isStaticv4}"},fieldLabel:"Primary DNS".t(),allowBlank:!1},{xtype:"textfield",bind:{value:"{si.v4StaticDns2}",hidden:"{!si.isWan || !isStaticv4}"},fieldLabel:"Secondary DNS".t()},{xtype:"textfield",bind:{value:"{si.v4AutoAddressOverride}",emptyText:"{si.v4Address}",hidden:"{!isAutov4}"},fieldLabel:"Address Override".t()},{xtype:"combo",bind:{value:"{si.v4AutoPrefixOverride}",hidden:"{!isAutov4}"},editable:!1,fieldLabel:"Netmask Override".t(),store:Ung.Util.v4NetmaskList,queryMode:"local"},{xtype:"textfield",bind:{value:"{si.v4AutoGatewayOverride}",emptyText:"{si.v4Gateway}",hidden:"{!isAutov4}"},fieldLabel:"Gateway Override".t()},{xtype:"textfield",bind:{value:"{si.v4AutoDns1Override}",emptyText:"{si.v4Dns1}",hidden:"{!isAutov4}"},fieldLabel:"Primary DNS Override".t()},{xtype:"textfield",bind:{value:"{si.v4AutoDns2Override}",emptyText:"{si.v4Dns2}",hidden:"{!isAutov4}"},fieldLabel:"Secondary DNS Override".t()},{xtype:"button",text:"Renew DHCP Lease".t(),margin:"0 0 15 200",bind:{hidden:"{!isAutov4}"}},{xtype:"textfield",bind:{value:"{si.v4PPPoEUsername}",hidden:"{!isPPPOEv4}"},fieldLabel:"Username".t()},{xtype:"textfield",inputType:"password",bind:{value:"{si.v4PPPoEPassword}",hidden:"{!isPPPOEv4}"},fieldLabel:"Password".t()},{xtype:"checkbox",bind:{value:"{si.v4PPPoEUsePeerDns}",hidden:"{!isPPPOEv4}"},fieldLabel:"Use Peer DNS".t()},{xtype:"textfield",bind:{value:"{si.v4PPPoEDns1}",hidden:"{!isPPPOEv4 || si.v4PPPoEUsePeerDns}"},fieldLabel:"Primary DNS".t()},{xtype:"textfield",bind:{value:"{si.v4PPPoEDns2}",hidden:"{!isPPPOEv4 || si.v4PPPoEUsePeerDns}"},fieldLabel:"Secondary DNS".t()},{xtype:"fieldset",title:"IPv4 Options".t(),items:[{xtype:"checkbox",bind:{value:"{si.v4NatEgressTraffic}",hidden:"{!si.isWan}"},boxLabel:"NAT traffic exiting this interface (and bridged peers)".t()},{xtype:"checkbox",bind:{value:"{si.v4NatIngressTraffic}",hidden:"{si.isWan}"},boxLabel:"NAT traffic coming from this interface (and bridged peers)".t()}]}]},{xtype:"fieldset",title:"IPv6 Configuration".t(),collapsible:!0,defaults:{xtype:"textfield",labelWidth:190,labelAlign:"right",anchor:"100%"},hidden:!0,bind:{hidden:"{!isAddressed}",collapsed:"{isDisabledv6}"},items:[{xtype:"segmentedbutton",allowMultiple:!1,bind:{value:"{si.v6ConfigType}",hidden:"{!si.isWan}"},margin:"10 0",items:[{text:"Disabled".t(),value:"DISABLED"},{text:"Auto (SLAAC/RA)".t(),value:"AUTO"},{text:"Static".t(),value:"STATIC"}]},{bind:{value:"{si.v6StaticAddress}",hidden:"{isDisabledv6 || isAutov6}"},fieldLabel:"Address".t()},{bind:{value:"{si.v6StaticPrefixLength}",hidden:"{isDisabledv6 || isAutov6}"},fieldLabel:"Prefix Length".t()},{bind:{value:"{si.v6StaticGateway}",hidden:"{isDisabledv6 || isAutov6 || !si.isWan}"},fieldLabel:"Gateway".t()},{bind:{value:"{si.v6StaticDns1}",hidden:"{isDisabledv6 || isAutov6 || !si.isWan}"},fieldLabel:"Primary DNS".t()},{bind:{value:"{si.v6StaticDns2}",hidden:"{isDisabledv6 || isAutov6 || !si.isWan}"},fieldLabel:"Secondary DNS".t()},{xtype:"fieldset",title:"IPv6 Options".t(),bind:{hidden:"{isDisabledv6 || isAutov6 || si.isWan}"},items:[{xtype:"checkbox",bind:{value:"{si.raEnabled}"},boxLabel:"Send Router Advertisements".t()},{xtype:"label",style:{fontSize:"10px"},html:'<span style="color: red">'+"Warning:".t()+"</span> "+"SLAAC only works with /64 subnets.".t(),bind:{hidden:"{!showRouterWarning}"}}]}]},{xtype:"fieldset",title:"DHCP Configuration",collapsible:!0,defaults:{labelWidth:190,labelAlign:"right",anchor:"100%"},hidden:!0,bind:{hidden:"{!isAddressed || si.isWan}"},items:[{xtype:"checkbox",bind:"{si.dhcpEnabled}",boxLabel:"Enable DHCP Serving".t()},{xtype:"textfield",bind:{value:"{si.dhcpRangeStart}",hidden:"{!si.dhcpEnabled}"},fieldLabel:"Range Start".t(),allowBlank:!1,disableOnly:!0},{xtype:"textfield",bind:{value:"{si.dhcpRangeEnd}",hidden:"{!si.dhcpEnabled}"},fieldLabel:"Range End".t(),allowBlank:!1,disableOnly:!0},{xtype:"numberfield",bind:{value:"{si.dhcpLeaseDuration}",hidden:"{!si.dhcpEnabled}"},fieldLabel:"Lease Duration".t()+" "+"(seconds)".t(),allowDecimals:!1,allowBlank:!1,disableOnly:!0},{xtype:"fieldset",title:"DHCP Advanced".t(),collapsible:!0,collapsed:!0,defaults:{labelWidth:180,labelAlign:"right",anchor:"100%"},bind:{hidden:"{!si.dhcpEnabled}"},items:[{xtype:"textfield",bind:"{si.dhcpGatewayOverride}",fieldLabel:"Gateway Override".t()},{xtype:"combo",bind:"{si.dhcpPrefixOverride}",fieldLabel:"Netmask Override".t(),editable:!1,store:Ung.Util.v4NetmaskList,queryMode:"local"},{xtype:"textfield",bind:"{si.dhcpDnsOverride}",fieldLabel:"DNS Override".t()}]}]},{xtype:"fieldset",title:"Redundancy (VRRP) Configuration".t(),collapsible:!0,defaults:{labelWidth:190,labelAlign:"right",anchor:"100%"},hidden:!0,bind:{hidden:"{!isAddressed || !isStaticv4}"},items:[{xtype:"checkbox",bind:"{si.vrrpEnabled}",boxLabel:"Enable VRRP".t()},{xtype:"numberfield",bind:{value:"{si.vrrpId}",hidden:"{!si.vrrpEnabled}"},fieldLabel:"VRRP ID".t(),minValue:1,maxValue:255,allowBlank:!1,blankText:"VRRP ID must be a valid integer between 1 and 255.".t()},{xtype:"numberfield",bind:{value:"{si.vrrpPriority}",hidden:"{!si.vrrpEnabled}"},fieldLabel:"VRRP Priority".t(),minValue:1,maxValue:255,allowBlank:!1,blankText:"VRRP Priority must be a valid integer between 1 and 255.".t()}]}]}]}]}),Ext.define("Ung.config.network.view.NatRules",{extend:"Ext.panel.Panel",alias:"widget.config.network.natrules",viewModel:!0,requires:[],title:"NAT Rules".t(),layout:"fit",tbar:[{xtype:"displayfield",padding:"0 10",value:"NAT Rules control the rewriting of the IP source address of traffic (Network Address Translation). The rules are evaluated in order.".t()}],items:[{xtype:"rules",flex:3,columnFeatures:["reorder","delete","edit"],recordActions:["@edit","@delete"],listProperty:"settings.natRules.list",ruleJavaClass:"com.untangle.uvm.network.NatRuleCondition",conditions:[{name:"DST_ADDR",displayName:"Destination Address".t(),type:"textfield",visible:!0,vtype:"ipall"},{name:"DST_PORT",displayName:"Destination Port".t(),type:"textfield",vtype:"port",visible:!0},{name:"DST_INTF",displayName:"Destination Interface".t(),type:"checkboxgroup",values:[["a","a"],["b","b"]],visible:!0},{name:"SRC_ADDR",displayName:"Source Address".t(),type:"textfield",visible:!0,vtype:"ipall"},{name:"SRC_PORT",displayName:"Source Port".t(),type:"numberfield",vtype:"port",visible:rpc.isExpertMode},{name:"SRC_INTF",displayName:"Source Interface".t(),type:"checkboxgroup",values:[["a","a"],["b","b"]],visible:!0},{name:"PROTOCOL",displayName:"Protocol".t(),type:"checkboxgroup",values:[["TCP","TCP"],["UDP","UDP"],["ICMP","ICMP"],["GRE","GRE"],["ESP","ESP"],["AH","AH"],["SCTP","SCTP"]],visible:!0}],label:"Perform the following action(s):".t(),description:"NAT Rules control the rewriting of the IP source address of traffic (Network Address Translation). The rules are evaluated in order.".t(),emptyRow:{ruleId:-1,enabled:!0,auto:!0,javaClass:"com.untangle.uvm.network.NatRule",conditions:{javaClass:"java.util.LinkedList",list:[]},description:""},bind:"{natRules}",columns:[{header:"Rule Id".t(),width:70,align:"right",resizable:!1,dataIndex:"ruleId",renderer:function(e){return e<0?"new".t():e}},{xtype:"checkcolumn",header:"Enable".t(),dataIndex:"enabled",resizable:!1,width:70,editor:{xtype:"checkbox",fieldLabel:"Enable NAT Rule".t(),bind:"{record.enabled}"}},{header:"Description",width:200,dataIndex:"description",renderer:function(e){return e?e:"<em>no description<em>"},editor:{xtype:"textfield",fieldLabel:"Description".t(),bind:"{record.description}",emptyText:"[no description]".t(),allowBlank:!1}},{header:"Conditions".t(),itemId:"conditions",flex:1,dataIndex:"conditions",renderer:"conditionsRenderer"},{header:"NAT Type".t(),dataIndex:"auto",width:100,renderer:function(e){return e?"Auto".t():"Custom".t()},editor:{xtype:"combo",fieldLabel:"NAT Type".t(),bind:"{record.auto}",allowBlank:!1,editable:!1,store:[[!0,"Auto".t()],[!1,"Custom".t()]],queryMode:"local"}},{header:"New Source".t(),dataIndex:"newSource",width:120,renderer:function(e,t,i){return i.get("auto")?"":e},editor:{xtype:"textfield",fieldLabel:"New Source".t(),width:100,bind:{value:"{record.newSource}",disabled:"{record.auto}"},allowBlank:!0,vtype:"ipall"}}]}]}),Ext.define("Ung.config.network.view.PortForwardRules",{extend:"Ext.panel.Panel",alias:"widget.config.network.portforwardrules",viewModel:!0,requires:[],title:"Port Forward Rules".t(),layout:{type:"vbox",align:"stretch"},tbar:[{xtype:"displayfield",padding:"0 10",value:"Port Forward rules forward sessions matching the configured criteria from a public IP to an IP on an internal (NAT'd) network. The rules are evaluated in order.".t()}],items:[{xtype:"rules",flex:3,columnFeatures:["reorder","delete","edit"],recordActions:["@edit","@delete"],listProperty:"settings.portForwardRules.list",ruleJavaClass:"com.untangle.uvm.network.PortForwardRuleCondition",conditions:[{name:"DST_LOCAL",displayName:"Destined Local".t(),type:"boolean",visible:!0},{name:"DST_ADDR",displayName:"Destination Address".t(),type:"textfield",visible:!0,vtype:"ipall"},{name:"DST_PORT",displayName:"Destination Port".t(),type:"textfield",vtype:"port",visible:!0},{name:"SRC_ADDR",displayName:"Source Address".t(),type:"textfield",visible:!0,vtype:"ipall"},{name:"SRC_PORT",displayName:"Source Port".t(),type:"numberfield",vtype:"port",visible:rpc.isExpertMode},{name:"SRC_INTF",displayName:"Source Interface".t(),type:"checkboxgroup",values:[["a","a"],["b","b"]],visible:!0},{name:"PROTOCOL",displayName:"Protocol".t(),type:"checkboxgroup",values:[["TCP","TCP"],["UDP","UDP"],["ICMP","ICMP"],["GRE","GRE"],["ESP","ESP"],["AH","AH"],["SCTP","SCTP"]],visible:!0}],label:"Forward to the following location:".t(),description:"Port Forward rules forward sessions matching the configured criteria from a public IP to an IP on an internal (NAT'd) network. The rules are evaluated in order.".t(),emptyRow:{ruleId:-1,simple:!0,enabled:!0,javaClass:"com.untangle.uvm.network.PortForwardRule",conditions:{javaClass:"java.util.LinkedList",list:[{conditionType:"DST_LOCAL",invert:!1,value:"true",javaClass:"com.untangle.uvm.network.PortForwardRuleCondition"},{conditionType:"PROTOCOL",invert:!1,value:"TCP",javaClass:"com.untangle.uvm.network.PortForwardRuleCondition"},{conditionType:"DST_PORT",invert:!1,value:"80",javaClass:"com.untangle.uvm.network.PortForwardRuleCondition"}]},newPort:80},bind:"{portForwardRules}",columns:[{header:"Rule Id".t(),width:70,align:"right",resizable:!1,dataIndex:"ruleId",renderer:function(e){return e<0?"new".t():e}},{xtype:"checkcolumn",header:"Enable".t(),dataIndex:"enabled",resizable:!1,width:70,editor:{xtype:"checkbox",fieldLabel:"Enable Port Forward Rule".t(),bind:"{record.enabled}"}},{header:"Description",width:200,dataIndex:"description",renderer:function(e){return e||"<em>no description<em>"},editor:{xtype:"textfield",fieldLabel:"Description".t(),bind:"{record.description}",emptyText:"[no description]".t(),allowBlank:!1}},{header:"Conditions".t(),itemId:"conditions",flex:1,dataIndex:"conditions",renderer:"conditionsRenderer"},{header:"New Destination".t(),dataIndex:"newDestination",width:150,editor:{xtype:"textfield",fieldLabel:"New Destination".t(),bind:"{record.newDestination}",allowBlank:!1,vtype:"ipall"}},{header:"New Port".t(),dataIndex:"newPort",width:80,editor:{xtype:"numberfield",fieldLabel:"New Port".t(),width:100,bind:"{record.newPort}",allowBlank:!0,minValue:1,maxValue:65535,vtype:"port"}}]},{xtype:"fieldset",flex:2,margin:10,collapsible:!0,collapsed:!1,autoScroll:!0,title:"The following ports are currently reserved and can not be forwarded:".t(),items:[{xtype:"component",name:"portForwardWarnings",html:" "}]}]}),Ext.define("Ung.config.network.view.Routes",{extend:"Ext.panel.Panel",alias:"widget.config.network.routes",viewModel:!0,title:"Routes".t(),layout:"border",tbar:[{xtype:"displayfield",padding:"0 10",value:"Static Routes are global routes that control how traffic is routed by destination address. The most specific Static Route is taken for a particular packet, order is not important.".t()}],items:[{xtype:"rules",region:"center",columnFeatures:["reorder","delete","edit"],recordActions:["@edit","@delete"],dataProperty:"settings.staticRoutes.list",conditions:[{name:"DST_LOCAL",displayName:"Destined Local".t(),type:"boolean",visible:!0},{name:"DST_ADDR",displayName:"Destination Address".t(),type:"textfield",visible:!0,vtype:"ipall"},{name:"DST_PORT",displayName:"Destination Port".t(),type:"textfield",vtype:"port",visible:!0},{name:"SRC_ADDR",displayName:"Source Address".t(),type:"textfield",visible:!0,vtype:"ipall"},{name:"SRC_PORT",displayName:"Source Port".t(),type:"numberfield",vtype:"port",visible:rpc.isExpertMode},{name:"SRC_INTF",displayName:"Source Interface".t(),type:"checkboxgroup",values:[["a","a"],["b","b"]],visible:!0},{name:"PROTOCOL",displayName:"Protocol".t(),type:"checkboxgroup",values:[["TCP","TCP"],["UDP","UDP"],["ICMP","ICMP"],["GRE","GRE"],["ESP","ESP"],["AH","AH"],["SCTP","SCTP"]],visible:!0}],label:"Forward to the following location:".t(),description:"Port Forward rules forward sessions matching the configured criteria from a public IP to an IP on an internal (NAT'd) network. The rules are evaluated in order.".t(),emptyRow:{ruleId:-1,network:"",prefix:24,nextHop:"4.3.2.1",javaClass:"com.untangle.uvm.network.StaticRoute",description:""},bind:"{staticRoutes}",columns:[{header:"Description".t(),dataIndex:"description",flex:1,editor:{xtype:"textfield",fieldLabel:"Description".t(),bind:"{record.description}",allowBlank:!1,emptyText:"[enter description]".t()}},{header:"Network".t(),width:170,dataIndex:"network",editor:{xtype:"textfield",fieldLabel:"Network".t(),emptyText:"1.2.3.0".t(),allowBlank:!1,vtype:"ipall",bind:"{record.network}"}},{header:"Netmask/Prefix".t(),width:170,dataIndex:"prefix",editor:{xtype:"combo",fieldLabel:"Netmask/Prefix".t(),bind:"{record.prefix}",store:Ung.Util.getV4NetmaskList(!1),queryMode:"local",editable:!1}},{header:"Next Hop".t(),width:300,dataIndex:"nextHop",editor:{xtype:"combo",fieldLabel:"Next Hop".t(),bind:"{record.nextHop}",queryMode:"local",allowBlank:!1,editable:!0}},{hidden:!0,editor:{xtype:"component",margin:"10 0 0 20",html:"If <b>Next Hop</b> is an IP address that network will be routed via the specified IP address.".t()+"<br/>"+"If <b>Next Hop</b> is an interface that network will be routed <b>locally</b> on that interface.".t()}}]},{xtype:"panel",title:"Current Routes".t(),region:"south",height:"50%",split:!0,border:!1,tbar:[{xtype:"displayfield",padding:"0 5",value:"Current Routes shows the current routing system's configuration and how all traffic will be routed.".t()},"->",{text:"Refresh Routes".t(),iconCls:"fa fa-refresh",handler:"refreshRoutes"}],layout:"fit",items:[{xtype:"textarea",itemId:"currentRoutes",border:!1,fieldStyle:{fontFamily:"monospace"},hideLabel:!0,labelSeperator:"",readOnly:!0}]}]}),Ext.define("Ung.config.network.view.Services",{extend:"Ext.panel.Panel",alias:"widget.config.network.services",viewModel:!0,title:"Services".t(),padding:10,items:[{xtype:"fieldset",title:"Local Services".t(),defaults:{allowDecimals:!1,minValue:0,allowBlank:!1,vtype:"port"},items:[{xtype:"component",html:"<br/>"+"The specified HTTPS port will be forwarded from all interfaces to the local HTTPS server to provide administration and other services.".t()+"<br/>",margin:"0 0 10 0"},{xtype:"numberfield",fieldLabel:"HTTPS port".t(),name:"httpsPort",bind:"{settings.httpsPort}",blankText:"You must provide a valid port.".t()},{xtype:"component",html:"<br/>"+"The specified HTTP port will be forwarded on non-WAN interfaces to the local HTTP server to provide administration, blockpages, and other services.".t()+"<br/>",margin:"0 0 10 0"},{xtype:"numberfield",fieldLabel:"HTTP port".t(),name:"httpPort",bind:"{settings.httpPort}",blankText:"You must provide a valid port.".t()}]}]}),Ext.define("Ung.config.network.view.Troubleshooting",{extend:"Ext.panel.Panel",alias:"widget.config.network.troubleshooting",title:"Troubleshooting".t(),layout:"fit",tbar:[{xtype:"displayfield",padding:"0 10",value:"<strong>"+"Network Tests".t()+"</strong>"}],items:[{xtype:"tabpanel",items:[{xtype:"networktest",title:"Connectivity Test".t(),viewModel:{data:{description:"The <b>Connectivity Test</b> verifies a working connection to the Internet.".t(),emptyText:"Connectivity Test Output".t(),command:["/bin/bash","-c",['echo -n "Testing DNS ... " ; success="Successful";','dig updates.untangle.com > /dev/null 2>&1; if [ "$?" = "0" ]; then echo "OK"; else echo "FAILED"; success="Failure"; fi;','echo -n "Testing TCP Connectivity ... ";','echo "GET /" | netcat -q 0 -w 15 updates.untangle.com 80 > /dev/null 2>&1;','if [ "$?" = "0" ]; then echo "OK"; else echo "FAILED"; success="Failure"; fi;','echo "Test ${success}!"'].join("")]}}},{xtype:"networktest",title:"Ping Test".t(),commandFields:[{xtype:"textfield",width:200,emptyText:"IP Address or Hostname".t(),allowBlank:!1,bind:"{destination}"}],viewModel:{data:{description:"The <b>Ping Test</b> can be used to test that a particular host or client can be pinged".t(),emptyText:"Ping Test Output".t(),destination:null},formulas:{command:function(e){return"ping -c 5 "+e("destination")}}}},{xtype:"networktest",title:"DNS Test".t(),commandFields:[{xtype:"textfield",width:200,emptyText:"Hostname".t(),allowBlank:!1,bind:"{destination}"}],viewModel:{data:{description:"The <b>DNS Test</b> can be used to test DNS lookups".t(),emptyText:"DNS Test Output".t(),destination:null},formulas:{command:function(e){return["/bin/bash","-c",["host '"+e("destination")+"';",'if [ "$?" = "0" ]; then echo "Test Successful"; else echo "Test Failure"; fi;'].join("")]}}}},{xtype:"networktest",title:"Connection Test".t(),commandFields:[{xtype:"textfield",width:200,emptyText:"IP Address or Hostname".t(),allowBlank:!1,bind:"{destination}"},{xtype:"numberfield",minValue:1,maxValue:65536,width:80,emptyText:"Port".t(),allowBlank:!1,bind:"{port}"}],viewModel:{data:{description:"The <b>Connection Test</b> verifies that Untangle can open a TCP connection to a port on the given host or client.".t(),emptyText:"Connection Test Output".t(),destination:null,port:null},formulas:{command:function(e){return["/bin/bash","-c",["echo 1 | netcat -q 0 -v -w 15 '"+e("destination")+"' '"+e("port")+"';",'if [ "$?" = "0" ]; then echo "Test Successful"; else echo "Test Failure"; fi;'].join("")]}}}},{xtype:"networktest",title:"Traceroute Test".t(),commandFields:[{xtype:"textfield",width:200,emptyText:"IP Address or Hostname".t(),allowBlank:!1,bind:"{destination}"},{xtype:"combo",editable:!1,width:100,store:[["U","UDP"],["T","TCP"],["I","ICMP"]],bind:"{protocol}"}],viewModel:{data:{description:"The <b>Traceroute Test</b> traces the route to a given host or client.".t(),emptyText:"Traceroute Test Output".t(),destination:"",protocol:"U"},formulas:{command:function(e){return["/bin/bash","-c",["traceroute -"+e("protocol")+" "+e("destination")+";",'if [ "$?" = "0" ]; then echo "Test Successful"; else echo "Test Failure"; fi;'].join("")]}}}},{xtype:"networktest",title:"Download Test".t(),commandFields:[{xtype:"combo",width:500,store:[["http://cachefly.cachefly.net/50mb.test","http://cachefly.cachefly.net/50mb.test"],["http://cachefly.cachefly.net/5mb.test","http://cachefly.cachefly.net/5mb.test"],["http://download.thinkbroadband.com/50MB.zip","http://download.thinkbroadband.com/50MB.zip"],["http://download.thinkbroadband.com/5MB.zip","http://download.thinkbroadband.com/5MB.zip"],["http://download.untangle.com/data.php","http://download.untangle.com/data.php"]],bind:"{url}"}],viewModel:{data:{description:"The <b>Download Test</b> downloads a file.".t(),emptyText:"Download Test Output".t(),url:"http://cachefly.cachefly.net/5mb.test"},formulas:{command:function(e){return["/bin/bash","-c",["wget --output-document=/dev/null  '"+e("url")+"' ;"].join("")]}}}},{xtype:"networktest",title:"Packet Test".t(),commandFields:[{xtype:"checkbox",boxLabel:"Advanced".t(),margin:"0 10 0 0",bind:"{advanced}"},{xtype:"textfield",width:200,emptyText:"IP Address or Hostname".t(),disabled:!0,bind:{value:"{destination}",disabled:"{!advanced}"}},{xtype:"numberfield",minValue:1,maxValue:65536,width:80,emptyText:"Port".t(),disabled:!0,bind:{value:"{port}",disabled:"{!advanced}"}},{xtype:"combo",fieldLabel:"Interface".t(),labelAlign:"right",editable:!1,forceSelection:!0,bind:{store:"{interfacesListSystemDev}",value:"{interface}"}},{xtype:"combo",fieldLabel:"Timeout".t(),labelAlign:"right",editable:!1,store:[[5,"5 seconds".t()],[30,"30 seconds".t()],[120,"120 seconds".t()]],bind:"{timeout}"}],viewModel:{data:{description:"The <b>Packet Test</b> can be used to view packets on the network wire for troubleshooting.".t(),emptyText:"Packet Test Output".t(),advanced:!0,destination:"any",port:"",timeout:5},formulas:{command:function(e){var t=["-U","-l","-v"],i=["-n","-s 65535","-i "+e("interface")],n=t.concat(i),a=[];e("advanced")||(null!==e("destination")&"any"!==e("destination").toLowerCase()&&a.push("host "+e("destination")),null!==e("port")&&a.push("port "+e("port")));var r=n.join(" ")+" "+a.join(" and ");return r},interfacesListSystemDev:function(e){var t,i=[],n=e("settings.interfaces.list");for(t=0;t<n.length;t+=1)i.push([n[t].systemDev,n[t].name]);return i.push(["tun0","OpenVPN"]),i},interface:function(e){return e("interfacesListSystemDev")[0][0]}}}}]}]});